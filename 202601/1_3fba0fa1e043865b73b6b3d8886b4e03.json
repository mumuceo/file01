[
    {
        "bookSourceUrl": "https://twkan.com/",
        "bookSourceName": "台湾小说",
        "enabledExplore": true,
        "enabled": true,
        "bookSourceGroup": "69",
        "author": "",
        "help": false,
        "html": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <title>默认书源</title>\n</head>\n<body>\n\n</body>\n<!-- 没用到jq请去掉-->\n<script src=\"https://vc.jd.com/web/js/jquery-3.1.1.min.js\"></script>\n<script>\n  var isCookieJar=true;// 不需要CookieJar请修改此处\n  class FlutterJSBridge {\n    constructor() {\n      this.init(); //前台webview 里必须删除这行\n    }\n\n    init() {\n      if (window.flutter_inappwebview) {\n        this.isReady = true;\n        this.CookieJar();\n      } else {\n        window.addEventListener('flutterInAppWebViewPlatformReady', () => {\n          this.isReady = true;\n          console.log('JSBridge初始化完成');\n          this.CookieJar();\n        });\n      }\n    }\n\n    //通知原生页面初始化完成，仅在书源和tts生效，webview请勿使用，只有通知加载成功后才允许运行，否则会一直等待加载成功\n    async CookieJar() {\n      try {\n        await window.flutter_inappwebview.callHandler('CookieJar', isCookieJar);\n      } catch (error) {\n        console.error('汇报完成准备失败:', error);\n      }\n    }\n\n    //获取应用编译版本\n    async getbuildNumber() {\n      try {\n        return await window.flutter_inappwebview.callHandler('buildNumber');\n      } catch (error) {\n        return  0;\n      }\n    }\n\n    //获取应用版本\n    async getversion() {\n      try {\n        return await window.flutter_inappwebview.callHandler('version');\n      } catch (error) {\n        return  \"0.0.0\";\n      }\n    }\n\n    //获取设备唯一id\n    async getDeviceid() {\n      try {\n        return await window.flutter_inappwebview.callHandler('id');\n      } catch (error) {\n        return  \"\";\n      }\n    }\n\n    //获取设备平台 此处返回 windows、macos、ios、ohos、android\n    async getDevice() {\n      try {\n        return await window.flutter_inappwebview.callHandler('device');\n      } catch (error) {\n        return  \"\";\n      }\n    }\n\n    //输出日志,前台webview请勿使用\n    //str 为 String\n    async log(str) {\n      try {\n        return await window.flutter_inappwebview.callHandler('log',str);\n      } catch (error) {\n        return  false;\n      }\n    }\n\n    //书源调试时可输出 html 代码到前台\n    //type 0 搜索源码 ， 1详情源码 ，2目录源码 ，3正文源码\n    //str 为 String\n    //type 为int\n    async text(type,str) {\n      try {\n        return await window.flutter_inappwebview.callHandler('text',type,str);\n      } catch (error) {\n        return  false;\n      }\n    }\n\n    //toast弹窗\n    //str 为 String\n    async showToast(str) {\n      try {\n        return await window.flutter_inappwebview.callHandler('showToast',str);\n      } catch (error) {\n        return  false;\n      }\n    }\n\n    //获取默认ua\n    async getWebViewUA() {\n      try {\n        return await window.flutter_inappwebview.callHandler('getWebViewUA');\n      } catch (error) {\n        return  \"\";\n      }\n    }\n\n    //通过url打开外部应用\n    //url 为 String\n    async openurl(url) {\n      try {\n        return await window.flutter_inappwebview.callHandler('openurl',url,\"\");\n      } catch (error) {\n        return  false;\n      }\n    }\n\n    //通过url打开外部应用并附带mimeType\n    //url 为 String\n    //mimeType 为 String\n    async openurlwithMimeType(url,mimeType) {\n      try {\n        return await window.flutter_inappwebview.callHandler('openurl',url,mimeType);\n      } catch (error) {\n        return  false;\n      }\n    }\n\n    /**\n     * 使用webView访问网络\n     * @param html 直接用webView载入的html, 如果html为空直接访问url\n     * @param url html内如果有相对路径的资源不传入url访问不了\n     * @param js 用来取返回值的js语句, 没有就返回整个源代码\n     * @param body 当参数不为空的时候，会以post请求，此时请务必在 header 中带上content-type\n     * @param header 请求的header头，此参数必须是json字符串\n     * @return 返回js获取的内容\n     */\n    async webview(url,js,html,body,header) {\n      try {\n        return await window.flutter_inappwebview.callHandler('webview',url,js,html,body,header,\"\",\"\");\n      } catch (error) {\n        return  \"\";\n      }\n    }\n\n    /**\n     * overrideUrlRegex 为正则表达式\n     * 使用方法和上面的一样\n     * 但返回的内容为正则到的内容，如果无法正则到则返回 js 获取的内容，如果 js 为空则返回页面 html\n     */\n    async webViewGetOverrideUrl(url,js,html,body,header,overrideUrlRegex) {\n      try {\n        return await window.flutter_inappwebview.callHandler('webview',url,js,html,body,header,overrideUrlRegex,\"\");\n      } catch (error) {\n        return  \"\";\n      }\n    }\n\n    /**\n     * 使用webView获取资源url\n     * urlregex 为正则表达式\n     * 使用方法和上面的一样\n     * 但返回的内容为正则到的内容，如果无法正则到则返回 js 获取的内容，如果 js 为空则返回页面 html\n     */\n    async webViewGetSource(url,js,html,body,header,urlregex) {\n      try {\n        return await window.flutter_inappwebview.callHandler('webview',url,js,html,body,header,\"\",urlregex);\n      } catch (error) {\n        return  \"\";\n      }\n    }\n\n\n    /**\n     * 启动前台 webview 访问链接并获取结束时的 html，可用于手工过盾\n     * @param url 网址\n     * @param title 标题\n     * @param header 请求的header头，此参数必须是json字符串\n     * @return 返回网页的内容\n     */\n    async startBrowser(url,title,header) {\n      try {\n        return await window.flutter_inappwebview.callHandler('startBrowser',url,title,header);\n      } catch (error) {\n        return  \"\";\n      }\n    }\n\n    //专门为段评设置的半屏显示，不返回任何东西\n    async startBrowserDp(url,title) {\n      try {\n        return await window.flutter_inappwebview.callHandler('startBrowserDp',url,title);\n      } catch (error) {\n        return  \"\";\n      }\n    }\n\n    //仅前台webview可以使用，返回按钮，返回上一个页面\n    async back() {\n      try {\n        return await window.flutter_inappwebview.callHandler('back');\n      } catch (error) {\n        return  false;\n      }\n    }\n\n    //将 utf8字符串转到 gbk 并 url 编码\n    async utf8ToGbkUrlEncoded(str) {\n      try {\n        return await window.flutter_inappwebview.callHandler('utf8ToGbkUrlEncoded',str);\n      } catch (error) {\n        return  \"\";\n      }\n    }\n\n    /*\n    * @param str为图片链接\n    * @param header 请求的header头，此参数必须是json字符串\n    * 此函数是让用户输入图片中的验证码，当链接为空则直接让用户输入验证码\n    */\n    async getVerificationCode(str,header) {\n      try {\n        return await window.flutter_inappwebview.callHandler('getVerificationCode',str,header);\n      } catch (error) {\n        return  \"\";\n      }\n    }\n\n    //提交内容书本信息 json 后的字符串\n    async addbook(book) {\n      try {\n        return await window.flutter_inappwebview.callHandler('addbook',book);\n      } catch (error) {\n        return  \"\";\n      }\n    }\n\n    //utf8 字符串转base64\n    async base64encode(str) {\n      try {\n        return await window.flutter_inappwebview.callHandler('base64encode',str);\n      } catch (error) {\n        return  \"\";\n      }\n    }\n\n    //base64 转utf8字符串\n    async base64decode(str) {\n      try {\n        return await window.flutter_inappwebview.callHandler('base64decode',str);\n      } catch (error) {\n        return  \"\";\n      }\n    }\n\n\n\n  }\n\n  //webview请勿使用\n  //以下提交的url，headers,body 都必须为字符串,headers必须为json字符串\n  //当followRedirects 为 false 时不处理重定向，当为 true 时会自动处理重定向 ，如不明白用途直接用 true 最佳\n  // 以下所有参数除当followRedirects外均为 String\n  class Http {\n    constructor() {}\n\n    /*\n     * 通用返回字段\n     * method post get 或者 head\n     * body 请求返回后的字节的 base64\n     * headers  map<String,List<String>> 可通过headers[\"\"]来或者\n     * statusCode 状态码\n     * statusMessage\n     * data 返回后的字节 格式化后的内容\n     */\n    async Get(url,headers,followRedirects) {\n      try {\n        return await window.flutter_inappwebview.callHandler('http',\"get\",url,\"\",JSON.stringify(headers),followRedirects,\"\");\n      } catch (error) {\n        return  null;\n      }\n    }\n\n    async Head(url,headers,followRedirects) {\n      try {\n        return await window.flutter_inappwebview.callHandler('http',\"head\",url,\"\",JSON.stringify(headers),followRedirects,\"\");\n      } catch (error) {\n        return  null;\n      }\n    }\n\n\n    async Post(url,headers,body,contenttype,followRedirects) {\n      try {\n        return await window.flutter_inappwebview.callHandler('http',\"post\",url,body,JSON.stringify(headers),followRedirects,contenttype);\n      } catch (error) {\n        return  null;\n      }\n    }\n  }\n\n  class Cache {\n    constructor() {}\n    async get(key) {\n      try {\n        return await window.flutter_inappwebview.callHandler('cache.get',key);\n      } catch (error) {\n        return  null;\n      }\n    }\n\n    async set(key,value) {\n      try {\n        return await window.flutter_inappwebview.callHandler('cache.set',key,value);\n      } catch (error) {\n        return  null;\n      }\n    }\n\n    async remove(key) {\n      try {\n        return await window.flutter_inappwebview.callHandler('cache.remove',key);\n      } catch (error) {\n        return  null;\n      }\n    }\n\n    //如果登录为弹窗格式的，里面输入框输入的内容可以通过这个函数获取，默认返回的json格式或者为空，需要自行转换\n    async getLoginInfo(){\n      return await  this.get(\"LoginInfo\")\n    }\n\n    //将修改后的弹窗输入内容报错 ，必须 JSON.stringify，不然会出错\n    async putLoginInfo(info){\n      return await  this.set(\"LoginInfo\",info)\n    }\n\n    //获取书本变量\n    async getbookVariable(bookurl){\n      return await  this.get(bookurl)\n    }\n\n    //写入书本变量\n    async setbookVariable(bookurl,value){\n      return await  this.set(bookurl,value)\n    }\n  }\n\n  class Cookie {\n    constructor() {}\n\n    //通过url获取当前url的所有cookie\n    async get(url) {\n      try {\n        return await window.flutter_inappwebview.callHandler('cookie.get',url);\n      } catch (error) {\n        return  null;\n      }\n    }\n\n    //通过url删除当前url的所有cookie\n    async remove(url) {\n      try {\n        return await window.flutter_inappwebview.callHandler('cookie.remove',url);\n      } catch (error) {\n        return  null;\n      }\n    }\n\n\n    //通过url保存当前url的所有cookie\n    async set(url,value) {\n      try {\n        return await window.flutter_inappwebview.callHandler('cookie.set',url,value);\n      } catch (error) {\n        return  null;\n      }\n    }\n\n    //设置单独一个cookie\n    async setCookie(url,key,value) {\n      try {\n        return await window.flutter_inappwebview.callHandler('cookie.setcookie',url,key,value);\n      } catch (error) {\n        return  null;\n      }\n    }\n\n    //通过 url 获取单个 cookie 的值\n    async getCookie(url,value) {\n      try {\n        return await window.flutter_inappwebview.callHandler('cookie.getCookie',url,value);\n      } catch (error) {\n        return  null;\n      }\n    }\n  }\n\n  //安全的创建一个 div 解析 html\n  function parseHTMLSafely(htmlStr) {\n    try {\n      // 在函数作用域内创建独立的临时容器\n      // 每个调用创建新的jQuery对象，互不影响\n      var tempDiv = document.createElement('div');\n      tempDiv.innerHTML = htmlStr;\n      return $(tempDiv);\n    } catch (e) {\n      flutterBridge.log(\"HTML解析错误:\"+e.message);\n      return $('<div>');\n    }\n  }\n\n  //parseHTMLSafely 创建的用完后必须删除\n  function removeHTMLSafely(tempContainer) {\n    try {\n      tempContainer.innerHTML = '';\n      if (tempContainer.parentNode) {\n        tempContainer.parentNode.removeChild(tempContainer);\n      }\n    } catch (e) {\n      flutterBridge.log(\"HTML移除失败:\"+e.message);\n    }\n  }\n\n  //移除 css js，创建parseHTMLSafely前如果用不上 cssjs 建议移除\n  function removeHTMLTags(htmlString) {\n    // 移除script标签\n    let result = htmlString.replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, '');\n    // 移除style标签\n    result = result.replace(/<style\\b[^<]*(?:(?!<\\/style>)<[^<]*)*<\\/style>/gi, '');\n    return result;\n  }\n\n</script>\n\n\n<script>\n  const flutterBridge = new FlutterJSBridge();\n  const cache = new Cache();\n  const http = new Http();\n  const cookie = new Cookie();\n  var baseurl=\"https://twkan.com\";\n  var header={\n    \"User-Agent\": \"Mozilla/5.0 (Linux; Android 9) Mobile Safari/537.36\",\n  };\n  async function search(key,page) {\n    var url=baseurl+\"/search/\"+encodeURIComponent(key)+\"/\"+page+\".html\";\n    var get= await  http.Get(url.replaceAll(\"https\",\"http2\"),JSON.stringify(header),true);\n    var result=get.data;\n    if(result.match(/Just a moment/)){\n      var s=await  flutterBridge.startBrowser(url,\"验证\",JSON.stringify(header));\n      result=s;\n    }\n    flutterBridge.text(0,result )\n    var books=[];\n    var html = $.parseHTML( result );\n    $(html).find(\".newbox\").find(\"li\").each(function(index) {\n      var $element = $(this);\n      var img = $element.find(\"img\").attr('data-src');\n      var book={\n        \"bookUrl\":$element.find(\"a\").eq(0).attr('href'),\n        \"name\": $element.find(\"h3\").text(),\n        \"author\": $element.find(\"label\").eq(0).text(),\n        \"kind\":  $element.find(\"label\").eq(1).text(),\n        \"coverUrl\":img.replaceAll(\"https\",\"http2\").trim()+\",\"+JSON.stringify({\"headers\":header}),\n        \"intro\":$element.find(\".ellipsis_2\").text(),\n        \"tocUrl\":$element.find(\"a\").eq(0).attr('href'),\n        \"wordCount\":\"\",\n        \"type\":0,\n        \"latestChapterTitle\":$element.find(\".zxzj\").text().trim(),\n      }\n      books.push(book);\n    });\n    return JSON.stringify(books);\n  }\n\n  async function info(bookurl) {\n    var url=bookurl.replaceAll(\"https\",\"http2\");\n    var get=await http.Get(url,JSON.stringify(header),true);\n    flutterBridge.text(1,get.data );\n    var html = get.data;\n    \n    // 使用正则表达式提取meta标签内容\n    function getMetaContent(property) {\n      var regex = new RegExp('<meta[^>]*property=[\"\\']' + property + '[\"\\'][^>]*content=[\"\\']([^\"\\']+)[\"\\'][^>]*>', 'i');\n      var match = regex.exec(html);\n      return match ? match[1] : '';\n    }\n    \n    var book={\n      \"bookUrl\":bookurl,\n      \"name\": getMetaContent('og:title'),\n      \"author\": getMetaContent('og:novel:author'),\n      \"kind\": getMetaContent('og:novel:category'),\n      \"coverUrl\": getMetaContent('og:image').replaceAll(\"https\",\"http2\").trim()+\",\"+JSON.stringify({\"headers\":header}),\n      \"intro\": getMetaContent('description'),\n      \"tocUrl\":bookurl,\n      \"wordCount\":\"\",\n      \"type\":0,\n      \"latestChapterTitle\": getMetaContent('og:novel:latest_chapter_name'),\n    };\n    return JSON.stringify(book);\n  }\n\n  async function chapter(tocUrl) {\n    var s=tocUrl.split(\"book/\");\n    var url=baseurl+\"/ajax_novels/chapterlist/\"+s[1];\n    flutterBridge.log(url)\n    var get=await http.Get(url.replaceAll(\"https\",\"http2\"),JSON.stringify(header),true);\n    flutterBridge.text(2,get.data );\n    var chapters=[];\n    var html = $.parseHTML( get.data );\n    $(html).find(\"li\").each(function(index) {\n      var chapter={\n        \"name\" :$(this).find(\"a\").text(),\n        \"chapterId\":$(this).find(\"a\").attr('href'),\n        \"index\" :index,\n        \"isPay\":false,\n        \"isVip\":false,\n        \"isVolume\":false,\n        \"tag\":\"\"\n      };\n      chapters.push(chapter);\n    });\n    return JSON.stringify(chapters);\n  }\n\n  async function content(url) {\n    var get=await http.Get(url.replaceAll(\"https\",\"http2\"),JSON.stringify(header),true);\n    flutterBridge.text(3,get.data );\n    var contenttxt=\"\";\n    var html = $.parseHTML( get.data );\n    $(html).find(\"#txtcontent0\").each(function(index) {\n      var $child = $(this);\n      if($child.prop(\"tagName\").toLowerCase() == \"img\".toLowerCase()){\n        contenttxt=contenttxt+$child.html()+\"\\r\\n\";\n      }else{\n        var txt=$child.html()\n        contenttxt=contenttxt+txt;\n      }\n    })\n    contenttxt=contenttxt.replaceAll(\"</p><p>\",\"\\r\\n\").replaceAll(\"<br>\",\"\\r\\n\").replaceAll(\"<p>\",\"\").replaceAll(\"</p>\",\"\")\n    return contenttxt;\n  }\n\n  async function getfinds() {\n    var result = [];\n    var push = (title, url) => result.push({\n      title:title,\n      url: url && /_/.test(url) ? `/novels/${url}.html` : url,\n    });\n\n    push(\"书籍分类\", null, 1);\n\n    //const tag = org.jsoup.Jsoup.parse(Ajax(source.key + \"/novels/hot\")).select('.listleft li:not([class]) a');\n    var get=await http.Get((baseurl+\"/novels/hot\").replaceAll(\"https\",\"http2\"),JSON.stringify(header),true);\n    var html = $.parseHTML( get.data );\n    const sort = [\n      [\"全部\", \"monthvisit_0_0_1\"],\n      [\"连载\", \"newhot_0_0_1\"],\n      [\"全本\", \"newhot_0_1_1\"],\n      [\"人气\", \"weekvisit_0_0_1\"],\n      [\"推荐\", \"allvote_0_0_1\"],\n      [\"新书\", \"newhot_0_0_1\"]\n    ];\n\n    sort.forEach(([name, pattern]) => {\n      let Url = pattern.replace(/1$/, \"{{page}}\");\n      push(`༺ˇ»\\`ʚ  ${name}  ɞ´«ˇ༻`, Url, 1);\n    //  tag.toArray().forEach((e, i) => push(e.text(), Url.replace(/^(.+?_)0/, `$1${i+1}`), 0.25));\n      $(html).find(\".listleft a\").each(function(i) {\n        if(i != 0){\n          var e = $(this);\n          push(e.text(), Url.replace(/^(.+?_)0/, `$1${i}`))\n        }\n\n      })\n    });\n\n    push(\"༺ˇ»`ʚ  标签  ɞ´«ˇ༻\", null, 1);\n    var get=await http.Get((baseurl+\"/newtags\").replaceAll(\"https\",\"http2\"),JSON.stringify(header),true);\n    var html = $.parseHTML( get.data );\n    $(html).find(\".tag a\").each(function(index) {\n      var n = $(this);\n      push(n.text(), n.attr('href') + \"{{page}}\")\n    })\n    return   JSON.stringify(result);\n  }\n\n  async function find(url,page) {\n    var u=baseurl+url.replace(\"{{page}}\",page)\n    var get=await http.Get(u.replaceAll(\"https\",\"http2\"),JSON.stringify(header),true);\n    flutterBridge.text(0,get.data )\n    var books=[];\n    var html = $.parseHTML( get.data );\n    $(html).find(\".newbox\").find(\"li\").each(function(index) {\n      var $element = $(this);\n      var img = $element.find(\"img\").attr('data-src');\n      var book={\n        \"bookUrl\":$element.find(\"a\").eq(0).attr('href'),\n        \"name\": $element.find(\"h3\").text(),\n        \"author\": $element.find(\"label\").eq(0).text(),\n        \"kind\":  $element.find(\"label\").eq(1).text(),\n        \"coverUrl\":img.replaceAll(\"https\",\"http2\").trim()+\",\"+JSON.stringify({\"headers\":header}),\n        \"intro\":$element.find(\".ellipsis_2\").text(),\n        \"tocUrl\":$element.find(\"a\").eq(0).attr('href'),\n        \"wordCount\":\"\",\n        \"type\":0,\n        \"latestChapterTitle\":$element.find(\".zxzj\").text().trim(),\n      }\n      books.push(book);\n    });\n    return JSON.stringify(books);\n  }\n\n\n  //返回http开头的则任务登录链接会跳webview，其他的会按照json解析显示弹窗\n  async function getloginurl(){\n    return baseurl;\n  }\n\n  //如果登录 url 为非 http 开头的弹窗界面，每次修改完弹窗就会执行此函数\n  async function login(){\n\n  }\n\n  async function pay(bookurl,url){\n\n  }\n\n</script>\n\n</html>\n",
        "login": false
    }
]